1. Requirements Engineering
   1.1. User Story Description
   As an Agent, I want to publish a sale or rent advertisement.

1.2. Customer Specifications and Clarifications
From the specifications document:

The agent should choose the advertisement from a list of unpublished property listings assigned to them.

From the client clarifications:

Question: Should agents only see properties assigned to them?
Answer: Yes, agents must only see their assigned properties that are unpublished.
1.3. Acceptance Criteria
AC40-1: The agent should choose the advertisement from a list of unpublished property listings assigned to them.
AC40-2: Once selected, the advertisement must be marked as published.
1.4. Found Out Dependencies
The system must maintain a mapping of agents to properties.

1.5 Input and Output Data
Input Data:

Selected data:
A property from the list of unpublished properties assigned to the agent.
Output Data:

A success or failure message for the publication action.
1.6. System Sequence Diagram (SSD)

1.7 Other Relevant Remarks
Published advertisements should be ready to appear in the listing.

2. OO Analysis
   2.1. Relevant Domain Model Excerpt

2.2. Other Remarks
Properties must have a status (unpublished or published) stored with the Advertisement.

3. Design - User Story Realization
   3.1. Rationale
   Interaction ID	Question: Which class is responsible for...	Answer	Justification (with patterns)
   Step 1	... interacting with the actor?	PublishAdvertisementView	Pure Fabrication: there is no reason to assign this responsibility to any existing class.
   ... coordinating the US?	PublishAdvertisementCtrl	Controller
   ... providing the list of unpublished properties for the agent?	PropertyContainer	IE: Knows all the properties in the system.
   Step 2	... requesting data?	PublishAdvertisementView	IE: Responsible for user interaction.
   Step 3	... validating the selected property?	AdvertisementValidator	IE: Validates business rules, such as the status of the property.
   Step 4	... updating the advertisement status?	Advertisement	IE: Owns its data and ensures the integrity of its state.
   Step 5	... saving the updated advertisement?	PropertyContainer	IE: Responsible for maintaining the updated property list.
   Step 6	... informing the success or failure of the operation?	PublishAdvertisementView	IE: Responsible for user interaction.
   Systematization
   According to the rationale, the conceptual classes promoted to software classes are:

Advertisement
Property
Other software classes (i.e., Pure Fabrication) identified:

PublishAdvertisementView
PublishAdvertisementCtrl
PropertyContainer
AdvertisementValidator
3.2. Sequence Diagram (SD)
Alternative 1


Can you enumerate any problems with this conceptual solution? Yes, several:

If validation fails, the status update logic might remain incomplete.
It does not handle edge cases where the selected property is already published.
How to improve?

Alternative 2


Notice that:

Validation happens before updating the status.
The sequence is more robust and ensures atomicity of the operation.
OO principles such as encapsulation and single responsibility are preserved.
3.3. Class Diagram (CD)

Note: private methods were omitted.

4. Tests
   Three relevant test scenarios are highlighted next. Other tests were also specified.

Test 1: Check that the system filters unpublished properties for the agent.

cpp
Copiar c贸digo
TEST_F(PropertyContainerFixture, ListUnpublishedProperties) {
auto properties = this->container->getUnpublishedProperties("Agent1");
EXPECT_FALSE(properties.empty());
for (const auto& property : properties) {
EXPECT_EQ(property->getAssignedAgentID(), "Agent1");
EXPECT_FALSE(property->getAdvertisement()->isPublished());
}
}
Test 2: Check that publishing an unpublished advertisement succeeds.

cpp
Copiar c贸digo
TEST_F(AdvertisementFixture, PublishUnpublishedAd) {
auto ad = std::make_shared<Advertisement>("P001");
EXPECT_NO_THROW(ad->publish());
EXPECT_TRUE(ad->isPublished());
}
Test 3: Check that publishing an already published advertisement fails.

cpp
Copiar c贸digo
TEST_F(AdvertisementFixture, PublishAlreadyPublishedAd) {
auto ad = std::make_shared<Advertisement>("P001");
ad->publish();
EXPECT_THROW(ad->publish(), std::logic_error);
}
5. Integration and Demo
   A menu option in the console application was added to invoke the PublishAdvertisementView.

cpp
Copiar c贸digo
int AdvertisementsMenuView::processMenuOption(int option) {
int result = 0;
BaseView* view;
switch (option) {
case 1:
view = new PublishAdvertisementView(this->agentID, this->propertyContainer);
view->show();
break;
...
}
return result;
}
6. Observations
   n/a